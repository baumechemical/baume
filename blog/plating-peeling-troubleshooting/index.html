<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ชุบลอก/ลอกไม่หมด: สาเหตุ & วิธีแก้ | Baume Chemical Blog</title>

  <!-- SEO base -->
  <meta name="description" content="เช็คลิสต์เร็ว 3 ข้อ + 5 ต้นเหตุหลัก + แนวทางเตรียมผิว โปรไฟล์ไฟ/การจัดวาง อ่างและสารเติมแต่ง การทดสอบยึดเกาะ เคสลอกไม่หมด และตารางปัญหา-วิธีแก้" />
  <meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" />
  <link rel="canonical" href="https://www.baumechemical.com/blog/plating-peeling-troubleshooting/" />
  <link rel="alternate" hreflang="th" href="https://www.baumechemical.com/blog/plating-peeling-troubleshooting/" />
  <link rel="alternate" hreflang="en" href="https://www.baumechemical.com/blog/plating-peeling-troubleshooting/" />
  <link rel="alternate" hreflang="x-default" href="https://www.baumechemical.com/blog/plating-peeling-troubleshooting/" />
  <meta name="theme-color" content="#2c5e4e" />

  <!-- Open Graph / Twitter -->
  <meta property="og:locale" content="th_TH" />
  <meta property="og:locale:alternate" content="en_US" />
  <meta property="og:type" content="article" />
  <meta property="og:site_name" content="Baume Chemical" />
  <meta property="og:title" content="ชุบลอก/ลอกไม่หมด: สาเหตุ & วิธีแก้ — Baume Chemical Blog" />
  <meta property="og:description" content="เช็คลิสต์เร็ว สาเหตุหลัก วิธีแก้ ครอบคลุมการเตรียมผิว โปรไฟล์ไฟ อ่างและสารเติมแต่ง การทดสอบยึดเกาะ และกรณีลอกไม่หมด" />
  <meta property="og:url" content="https://www.baumechemical.com/blog/plating-peeling-troubleshooting/" />
  <meta property="og:image" content="https://i.imgur.com/3mWQsKe.jpeg" />
  <meta property="og:image:alt" content="Plating Peeling Troubleshooting — Baume Chemical Blog" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- JSON-LD -->
  <script type="application/ld+json">
    {"@context":"https://schema.org","@type":"BlogPosting","headline":"ชุบลอก/ลอกไม่หมด: สาเหตุ & วิธีแก้","url":"https://www.baumechemical.com/blog/plating-peeling-troubleshooting/","inLanguage":"th","description":"เช็คลิสต์เร็ว 3 ข้อ + 5 ต้นเหตุหลัก + แนวทางเตรียมผิว โปรไฟล์ไฟ/การจัดวาง อ่าง/สารเติมแต่ง การทดสอบยึดเกาะ เคสลอกไม่หมด และตารางปัญหา-วิธีแก้","publisher":{"@type":"Organization","name":"Baume Chemical","url":"https://www.baumechemical.com/"},"image":"https://i.imgur.com/3mWQsKe.jpeg"}
  </script>

  <!-- Fonts & Perf -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://flagcdn.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="preload" as="image" href="https://i.imgur.com/3mWQsKe.jpeg"/>

  <style>
    :root{
      --brand:#2c5e4e; --brand-2:#387b5b; --accent:#ff9800; --ink:#0f172a; --muted:#5b6675; --bg:#f4f6f5;
      --radius:14px; --shadow-1:0 8px 26px rgba(2,8,20,.06); --shadow-2:0 16px 40px rgba(2,8,20,.14);
      --logo-url:url('https://img2.pic.in.th/pic/Baume.jpg');
      --header-h:64px; --container:1200px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0}
    body{font-family:'Noto Sans Thai', system-ui, sans-serif; color:var(--ink); background:var(--bg); line-height:1.6}

    /* ===== GLASS HEADER: transparent start → dark on scroll, fixed ===== */
    .site-header{position:fixed; inset:0 0 auto 0; z-index:1400; background:transparent;
      border-bottom:1px solid rgba(255,255,255,.14);
      transition:background .2s ease, backdrop-filter .2s ease, box-shadow .2s ease}
    .site-header.is-scrolled{background:rgba(15,23,42,.70); backdrop-filter:saturate(140%) blur(10px); box-shadow:0 8px 26px rgba(2,8,20,.18)}
    .nav-bar{ max-width:var(--container); margin:0 auto; padding:10px 16px; display:flex; align-items:center; gap:14px; justify-content:space-between; min-height:var(--header-h) }
    .brand{display:flex; align-items:center; gap:10px; text-decoration:none}
    .brand-logo{width:42px;height:42px;border-radius:10px;background:#e8f1ec var(--logo-url) center/cover no-repeat;box-shadow:0 2px 8px rgba(2,8,20,.15)}
    .brand-name{font-weight:800; color:#fff}

    /* Primary nav + Lang switch (desktop inline / mobile inside dropdown) */
    .primary-nav{display:flex; align-items:center; gap:10px; flex-wrap:wrap}
    .menu{list-style:none;display:flex;gap:6px;margin:0;padding:0}
    .menu a{ text-decoration:none; color:#fff; padding:10px 12px; border-radius:10px; font-weight:700 }
    .menu a:hover{ background:rgba(255,255,255,.12) }
    .menu a[aria-current="page"]{ background:rgba(255,255,255,.18) }
    .lang-switch{display:flex; gap:6px; margin-left:auto; padding:4px; border:1px solid #e2e8f0; border-radius:999px; background:#ffffffcc; backdrop-filter: blur(8px); box-shadow:0 10px 26px rgba(2,8,20,.12)}
    .site-header.is-scrolled .lang-switch{background:#ffffffdd}
    .lang-btn{appearance:none; border:0; background:transparent; padding:6px 10px; border-radius:999px; font-weight:800; cursor:pointer; display:flex; align-items:center; gap:6px; color:#0f172a}
    .lang-btn[aria-pressed="true"]{ background:var(--brand-2); color:#fff }
    .flag{ width:18px; height:14px; border-radius:2px; object-fit:cover; box-shadow:0 0 0 1px rgba(0,0,0,.08) }

    @media(max-width:760px){ .brand-name{display:none} }

    /* Burger + dropdown */
    .nav-toggle{ display:none; width:38px; height:38px; border-radius:9px; background:transparent; cursor:pointer; border:0 }
    .nav-toggle .bar{ position:relative; width:22px; height:2px; background:#fff; border-radius:2px }
    .nav-toggle .bar::before,.nav-toggle .bar::after{content:""; position:absolute; left:0; right:0; height:2px; background:#fff; border-radius:2px}
    .nav-toggle .bar::before{top:-7px} .nav-toggle .bar::after{top:7px}
    .nav-toggle:focus-visible{outline:2px solid #fff; outline-offset:2px}

    @media (max-width:900px){
      .nav-toggle{ display:inline-flex; align-items:center; justify-content:center }
      .primary-nav{ position:fixed; left:12px; right:12px; top:calc(var(--header-h) + 8px); background:#0f172acc; border:1px solid rgba(255,255,255,.18); backdrop-filter: blur(8px); border-radius:14px; display:grid; gap:6px; padding:12px; z-index:1400; transform:translateY(-12px); opacity:0; pointer-events:none; transition:transform .2s ease,opacity .2s ease }
      .primary-nav .menu{ flex-direction:column; gap:4px }
      .primary-nav .menu a{ color:#fff; padding:12px 10px; }
      .site-header.open .primary-nav{ transform:none; opacity:1; pointer-events:auto }
      .lang-switch{ width:100%; margin:6px 0 0; background:#ffffff1c; border-color:rgba(255,255,255,.35); box-shadow:none }
      .lang-btn{ color:#fff }
      .lang-btn[aria-pressed="true"]{ background:#ffffff; color:#0f172a }
    }

    .menu-scrim{ position:fixed; inset:0; background:rgba(2,8,20,.28); z-index:1300; display:none }
    .menu-scrim:not([hidden]){ display:block }
    body.no-scroll{ position:fixed; width:100% }

    /* ===== Hero ===== */
    .hero{position:relative; overflow:hidden; display:grid; place-items:center; text-align:center; color:#fff; min-height: clamp(420px, 60vh, 620px); background: linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.6)), url('https://i.imgur.com/3mWQsKe.jpeg') center/cover no-repeat; padding: 28px 16px; padding-top:calc(var(--header-h) + 12px)}
    .hero h1{margin:6px 0 10px; font-weight:800; font-size:clamp(26px,4.2vw,44px); text-shadow:0 6px 28px rgba(0,0,0,.45)}
    .hero p{max-width:980px; margin:0 auto; color:#e6f2ef}
    .back-chip{position:absolute; top:calc(var(--header-h) + 10px); left:16px; z-index:1; display:inline-flex; align-items:center; gap:6px; padding:8px 12px; border-radius:999px; font-weight:800; text-decoration:none; background:#fff; border:1px solid rgba(2,8,20,.08); color:#0f172a; box-shadow:var(--shadow-1)}
    .back-chip:hover{ transform:translateY(-1px) }

    /* ===== Layout: 2 columns (sticky TOC on wide screens) ===== */
    .wrap{max-width:var(--container); margin:auto; padding:34px 16px}
    @media (min-width:1100px){
      main.wrap{ display:grid; grid-template-columns: 300px minmax(0,1fr); gap:20px; align-items:start }
      #toc{ grid-column:1; position:sticky; top:calc(var(--header-h) + 10px) }
      .part-switch{ grid-column:2; position:sticky; top:calc(var(--header-h) + 10px); z-index:1 }
      section.section-block{ grid-column:2 }
    }

    /* ===== TOC card ===== */
    #toc{ background:#fff;border:1px solid #e3ece5;border-radius:16px;padding:14px 16px;box-shadow:var(--shadow-1) }
    #toc h2.section{ font-size:1rem; margin:0 0 6px; display:flex; align-items:center; gap:10px }
    #toc p{display:grid;gap:8px;margin:10px 0 0}
    .toc-chip{display:flex; align-items:center; justify-content:space-between; width:100%; padding:12px 14px;border-radius:12px;background:#f2f7f4;border:1px solid #d8e7dd;color:#1f2a24;text-decoration:none;font-weight:800}
    .toc-chip:hover{filter:brightness(.98)}
    .toc-chip::after{ content:"›"; opacity:.55; color:var(--brand-2); font-weight:900 }
    .toc-chip[aria-current="true"]{background:var(--brand-2);color:#fff;border-color:transparent;box-shadow:0 6px 16px rgba(2,8,20,.12)}
    .toc-chip[aria-current="true"]::after{color:#fff;opacity:.9}

    /* ===== Section cards + gradient stripe + icons on H2 ===== */
    section.section-block{background:#fff; border:1px solid #e3ece5; border-radius:16px; padding:18px 16px; box-shadow:var(--shadow-1); position:relative; overflow:hidden; margin-bottom:16px; scroll-margin-top:calc(var(--header-h) + 18px)}
    section.section-block::after{content:""; position:absolute; left:0; right:0; bottom:0; height:4px; background:linear-gradient(90deg,var(--brand-2),#59a286,#9bd4b9); opacity:.85}
    h2.section{margin:0 0 8px; font-size:clamp(22px,2.6vw,30px); font-weight:800; color:#1f2a24; display:flex; align-items:center; gap:10px; position:relative}
    .section-block>h2.section::before{ content:var(--icon, "📘"); font-size:20px; line-height:1 }
    #tl>h2.section{ --icon:"⚡" }
    #causes>h2.section{ --icon:"🧩" }
    #prep>h2.section{ --icon:"🧼" }
    #power>h2.section{ --icon:"🔌" }
    #bath>h2.section{ --icon:"🧪" }
    #qa>h2.section{ --icon:"🧷" }
    #strip>h2.section{ --icon:"🧯" }
    #table>h2.section{ --icon:"🚨" }
    #links>h2.section{ --icon:"🔗" }
    .section-block>h2.section::after{ content:"#"; position:absolute; right:10px; top:50%; transform:translateY(-50%); opacity:0; transition:opacity .2s ease; font-weight:800; color:var(--muted); font-size:.92rem }
    .section-block:hover>h2.section::after{ opacity:.85 }

    /* Tables: glossy look */
    .table table{width:100%;border-collapse:separate;border-spacing:0;border:1px solid #e3ece5;border-radius:14px;overflow:hidden}
    .table thead th{background:linear-gradient(180deg,#f6fbf8,#eef6f1);position:relative}
    .table thead th::after{content:"";position:absolute;inset:0 0 auto 0;height:2px;background:linear-gradient(90deg,#d9efe4,transparent)}
    .table th,.table td{padding:12px 10px;border-bottom:1px solid #e9f0ea;vertical-align:top}
    .table tbody tr:nth-child(2n){background:#fbfdfc}
    .table tbody tr:hover{background:#f6fbf8}

    /* Part switcher */
    [hidden]{display:none !important}
    .part-switch{display:flex;gap:8px;align-items:center;margin:16px 0 14px}
    .part-btn{appearance:none;border:1px solid #d8e7dd;background:#ecf4ef;padding:8px 12px;border-radius:999px;font-weight:800;cursor:pointer}
    .part-btn[aria-pressed="true"]{background:var(--brand-2);color:#fff;border-color:transparent;box-shadow:0 6px 16px rgba(2,8,20,.12)}

    /* Footer */
    .site-footer{background:#0f172a; color:#cbd5e1; margin-top:24px}
    .site-footer a{color:#e2e8f0; text-decoration:none}
    .site-footer a:hover{color:#fff; text-decoration:underline}
    .footer-inner{max-width:var(--container); margin:0 auto; padding:38px 20px}
    .footer-grid{display:grid; gap:22px; grid-template-columns:2fr 1fr 1fr}
    @media(max-width:900px){ .footer-grid{grid-template-columns:1fr} }
    .footer-brand .ft-head{display:flex; align-items:center; gap:12px; margin:0 0 10px}
    .ft-logo{width:44px; height:44px; border-radius:10px; background:#2c5e4e; background-image:var(--logo-url); background-size:cover; background-position:center; box-shadow:0 3px 10px rgba(0,0,0,.3)}
    .ft-name{font-weight:800; color:#fff}
    .footer-title{margin:0 0 8px; color:#fff; font-weight:800; font-size:1.02rem}
    .footer-list{list-style:none; margin:8px 0 0; padding:0}
    .footer-list li{margin:6px 0}
    .footer-bottom{border-top:1px solid rgba(148,163,184,.25); margin-top:22px; padding-top:16px; display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap; font-size:.92rem; color:#9fb1c6}

    /* Reveal */
    .reveal{opacity:0; transform: translateY(14px); transition: opacity .5s ease, transform .5s ease}
    .reveal.show{opacity:1; transform:none}

    /* Utils */
    html{scroll-behavior:smooth}
  </style>
</head>
<body>

  <!-- ===== Header (glass, darken on scroll) ===== -->
  <header class="site-header" id="siteHeader" role="banner" aria-label="Site header">
    <div class="nav-bar">
      <a class="brand" href="https://www.baumechemical.com/" aria-label="Baume Chemical Home">
        <span class="brand-logo" aria-hidden="true"></span>
        <span class="brand-name">Baume Chemical</span>
      </a>

      <button class="nav-toggle" aria-expanded="false" aria-controls="primary-nav" aria-label="เปิดเมนู">
        <span class="bar"></span>
      </button>

      <!-- Menu + language switch -->
      <nav id="primary-nav" class="primary-nav" aria-label="Primary" aria-hidden="true">
        <ul class="menu">
          <li><a href="https://www.baumechemical.com/" data-i18n-key="nav_home">Home</a></li>
          <li><a href="https://www.baumechemical.com/about/" data-i18n-key="nav_about">About us</a></li>
          <li><a href="https://www.baumechemical.com/products/" data-i18n-key="nav_products">Products</a></li>
          <li><a href="https://www.baumechemical.com/contact/" data-i18n-key="nav_contact">Contact Us</a></li>
          <li><a href="https://www.baumechemical.com/blog/" data-i18n-key="nav_blog" aria-current="page">Blog</a></li>
        </ul>

        <div class="lang-switch" role="group" aria-label="Language switcher">
          <button class="lang-btn" data-lang="th" aria-pressed="true" title="ภาษาไทย">
            <img class="flag" src="https://flagcdn.com/24x18/th.png" srcset="https://flagcdn.com/48x36/th.png 2x" alt="TH"><span>ไทย</span>
          </button>
          <button class="lang-btn" data-lang="en" aria-pressed="false" title="English">
            <img class="flag" src="https://flagcdn.com/24x18/gb.png" srcset="https://flagcdn.com/48x36/gb.png 2x" alt="EN"><span>EN</span>
          </button>
        </div>
      </nav>
    </div>
  </header>
  <div class="menu-scrim" hidden></div>

  <!-- ===== Hero ===== -->
  <header class="hero">
    <div class="wrap" style="display:block; padding:28px 16px; max-width:var(--container); margin:auto">
      <a class="back-chip" href="https://www.baumechemical.com/" data-back data-i18n-key="back_home">← กลับเมนูหลัก</a>
      <h1 data-i18n-key="hero_title">ชุบลอก/ลอกไม่หมด: สาเหตุ & วิธีแก้</h1>
      <p data-i18n-key="hero_tagline">เช็คลิสต์ 3 นาที · 5 ต้นเหตุหลัก · วิธีเตรียมผิว/โปรไฟล์ไฟ/ดูแลอ่าง · การทดสอบยึดเกาะ · เคสลอกไม่หมด · ตารางปัญหา–วิธีแก้</p>
    </div>
  </header>

  <main class="wrap">
    <!-- Part Switcher -->
    <div class="part-switch" role="tablist" aria-label="เลือกพาร์ต">
      <button class="part-btn" role="tab" data-part="1" aria-pressed="true" aria-selected="true"><span data-i18n-key="part1">พาร์ต 1: TL;DR/สาเหตุ/เตรียมผิว/โปรไฟล์ไฟ/อ่าง</span></button>
      <button class="part-btn" role="tab" data-part="2" aria-pressed="false" aria-selected="false"><span data-i18n-key="part2">พาร์ต 2: QA/Strip ตารางปัญหา & ลิงก์</span></button>
    </div>

    <!-- TOC -->
    <nav id="toc" class="reveal" aria-label="สารบัญ">
      <h2 class="section" data-i18n-key="toc_title">สารบัญ</h2>
      <p>
        <a class="toc-chip" href="#tl" data-part="1" data-i18n-key="toc_tl">TL;DR – เช็คเร็ว</a>
        <a class="toc-chip" href="#causes" data-part="1" data-i18n-key="toc_causes">ต้นเหตุหลัก</a>
        <a class="toc-chip" href="#prep" data-part="1" data-i18n-key="toc_prep">การเตรียมผิว/Activation</a>
        <a class="toc-chip" href="#power" data-part="1" data-i18n-key="toc_power">โปรไฟล์ไฟ/การจัดวาง</a>
        <a class="toc-chip" href="#bath" data-part="1" data-i18n-key="toc_bath">อ่างชุบ & สารเติมแต่ง</a>
        <a class="toc-chip" href="#qa" data-part="2" data-i18n-key="toc_qa">การทดสอบยึดเกาะ (QA)</a>
        <a class="toc-chip" href="#strip" data-part="2" data-i18n-key="toc_strip">ลอกไม่หมดตอน Strip</a>
        <a class="toc-chip" href="#table" data-part="2" data-i18n-key="toc_table">ตารางปัญหา–วิธีแก้</a>
        <a class="toc-chip" href="#links" data-part="2" data-i18n-key="toc_links">ลิงก์ที่เกี่ยวข้อง</a>
      </p>
    </nav>

    <!-- Sections Part 1 -->
    <section id="tl" data-part="1" class="reveal section-block" aria-labelledby="tl-h">
      <h2 id="tl-h" class="section" data-i18n-key="tl_h">TL;DR – เช็คเร็ว 3 ข้อ</h2>
      <ul>
        <li data-i18n-key="tl_1">ผิวสะอาด/Active จริง? (ไม่มีน้ำมัน/ออกไซด์, ผ่าน water-break)</li>
        <li data-i18n-key="tl_2">โปรไฟล์ไฟเหมาะกับชิ้นงาน? (A/dm² ตรงสเปก, มีชิลด์/กระแสกระจายทั่ว)</li>
        <li data-i18n-key="tl_3">อ่างคงที่? (โลหะหลัก/สารเติมแต่ง/pH/อุณหภูมิบนสเปก, กรองดี)</li>
      </ul>
      <p class="lead" data-i18n-key="tl_note">“ลอกยกแผ่น” มักมาจากชั้นแรกยึดเกาะกับโลหะพื้นไม่ดี; “ลอกเป็นจุด/ขอบไหม้” มักเกี่ยวกับโปรไฟล์ไฟหรือสิ่งปนเปื้อนเฉพาะจุด</p>
    </section>

    <section id="causes" data-part="1" class="reveal section-block" aria-labelledby="causes-h">
      <h2 id="causes-h" class="section" data-i18n-key="causes_h">ต้นเหตุหลัก 5 กลุ่ม</h2>
      <ol>
        <li data-i18n-key="c1">ความสะอาดไม่พอ — คราบน้ำมัน/ออกไซด์/สารตกค้าง</li>
        <li data-i18n-key="c2">Activation ไม่ครบ — Fe/SS/Al/Zn die-cast ต้องขั้นพิเศษ</li>
        <li data-i18n-key="c3">Over-bright/อินทรีย์ล้น — ชั้นชุบเปราะ/ติดบนผิว passivation</li>
        <li data-i18n-key="c4">โปรไฟล์ไฟไม่เหมาะ — CD สูง/ต่ำไป, ขอบแหลมไม่มีชิลด์, ripple สูง</li>
        <li data-i18n-key="c5">อ่างเสื่อม/ปนเปื้อน — โลหะเจือ/คลอไรด์เกิน, pH/อุณหภูมิแกว่ง</li>
      </ol>
    </section>

    <section id="prep" data-part="1" class="reveal section-block" aria-labelledby="prep-h">
      <h2 id="prep-h" class="section" data-i18n-key="prep_h">การเตรียมผิว & Activation</h2>
      <ul>
        <li data-i18n-key="p1">ดีเกรส/ล้างไขมัน → ล้าง DI</li>
        <li data-i18n-key="p2">กัดคราบ/ดองผิว (etch/pickle) ให้ผิวใหม่สด</li>
        <li data-i18n-key="p3">Activation ตามโลหะพื้น (เช่น SS ใช้กรด/คอลลอยด์ Pd สำหรับ EN; Al/Zn die-cast เดสมัต + zincate; Ni เก่าให้ strike บางก่อน)</li>
        <li data-i18n-key="p4">Water-break test — น้ำต้องไหลเป็นแผ่นต่อเนื่อง</li>
      </ul>
    </section>

    <section id="power" data-part="1" class="reveal section-block" aria-labelledby="power-h">
      <h2 id="power-h" class="section" data-i18n-key="power_h">โปรไฟล์ไฟ & การวางชิ้นงาน</h2>
      <ul>
        <li data-i18n-key="pw1">เริ่ม CD ช่วงกลางของสเปกอ่าง แล้วค่อยปรับทีละขั้น</li>
        <li data-i18n-key="pw2">ขอบ/มุม ใช้ชิลด์หรือ current thief ลดไหม้/ลอกขอบ</li>
        <li data-i18n-key="pw3">ระยะขั้วเหมาะสม ลดความต่างศักย์เฉพาะจุด</li>
        <li data-i18n-key="pw4">ใช้เรคติไฟเออร์ ripple ต่ำ; บางงานใช้ pulse/pulse-reverse ช่วย</li>
        <li data-i18n-key="pw5">กวน/ไหลเวียนให้ผลิตภัณฑ์ปฏิกิริยาไม่ค้างหน้าชิ้นงาน</li>
      </ul>
    </section>

    <section id="bath" data-part="1" class="reveal section-block" aria-labelledby="bath-h">
      <h2 id="bath-h" class="section" data-i18n-key="bath_h">อ่างชุบ & สารเติมแต่ง</h2>
      <ul>
        <li data-i18n-key="b1">วิเคราะห์โลหะหลัก/คลอไรด์/บอเรต/คาร์บอเนตตามกราฟ</li>
        <li data-i18n-key="b2">ติดตามอินทรีย์/brightener — เกินทำให้เปราะ; คาร์บอนทรีตเมื่อจำเป็น</li>
        <li data-i18n-key="b3">คุม pH/อุณหภูมิให้คงที่ด้วยเครื่องมือสอบเทียบ</li>
        <li data-i18n-key="b4">กรองละเอียด 1–5 µm และแยกน้ำมันเพื่อลด pitting/คราบ</li>
      </ul>
    </section>

    <!-- Sections Part 2 -->
    <section id="qa" data-part="2" class="reveal section-block" aria-labelledby="qa-h">
      <h2 id="qa-h" class="section" data-i18n-key="qa_h">การทดสอบยึดเกาะ (QA)</h2>
      <div class="table">
        <table>
          <thead>
            <tr>
              <th data-i18n-key="qa_th_test">การทดสอบ</th>
              <th data-i18n-key="qa_th_crit">เกณฑ์โดยย่อ</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td data-i18n-key="qa_cross">Cross-hatch + เทป</td>
              <td data-i18n-key="qa_cross_c">ตัด 1–2 มม. ดึงเทป ไม่ยกแผ่นตามรอย</td>
            </tr>
            <tr>
              <td data-i18n-key="qa_bend">Bend test</td>
              <td data-i18n-key="qa_bend_c">งอ 180° ไม่ลอกเป็นแผ่น/ร้าว</td>
            </tr>
            <tr>
              <td data-i18n-key="qa_thermal">Thermal shock</td>
              <td data-i18n-key="qa_thermal_c">ร้อน–เย็นสลับ ไม่ปริ/ลอก</td>
            </tr>
            <tr>
              <td data-i18n-key="qa_hull">Hull cell + ความหนา</td>
              <td data-i18n-key="qa_hull_c">หน้าต่างอ่างสม่ำเสมอ ไม่ over-bright</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <section id="strip" data-part="2" class="reveal section-block" aria-labelledby="strip-h">
      <h2 id="strip-h" class="section" data-i18n-key="strip_h">“ลอกไม่หมด” ตอน Strip — เอาไงดี</h2>
      <ul>
        <li data-i18n-key="s1">เลือกสูตรให้ตรงชั้นชุบ (Cu/Ni/Cr/Sn/Zn) และป้องกันโลหะพื้น</li>
        <li data-i18n-key="s2">เพิ่มอุณหภูมิ/ความเข้มข้น/การกวนในกรอบสเปก</li>
        <li data-i18n-key="s3">ชิ้นซับซ้อนต้องกวน/ไหลเวียนดี ลดก๊าซกั้นผิว</li>
        <li data-i18n-key="s4">ชั้นผสม (Ni–P, Sn–Pb) อาจต้องสูตรเฉพาะ/ตัวเร่ง</li>
        <li data-i18n-key="s5">ล้างหลังลอกให้สะอาด เดสมัตเบาก่อนวนกลับไลน์</li>
      </ul>
      <p class="lead" data-i18n-key="strip_safe">ความปลอดภัย: สารลอกบางชนิดมีไซยาไนด์/ออกซิแดนต์แรง → ปฏิบัติตาม SDS และระบบกำจัดของเสีย</p>
    </section>

    <section id="table" data-part="2" class="reveal section-block" aria-labelledby="table-h">
      <h2 id="table-h" class="section" data-i18n-key="tab_h">ตารางปัญหา – สาเหตุ – วิธีแก้</h2>
      <div class="table">
        <table>
          <thead>
            <tr>
              <th data-i18n-key="tab_sym">อาการ</th>
              <th data-i18n-key="tab_cause">สาเหตุที่พบบ่อย</th>
              <th data-i18n-key="tab_fix">แนวทางแก้</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td data-i18n-key="t1_s">ลอกยกแผ่นทั้งผิว</td>
              <td data-i18n-key="t1_c">ผิวไม่ Active/มีน้ำมัน/ออกไซด์</td>
              <td data-i18n-key="t1_f">เพิ่มดีเกรส/etch/activate · ตรวจ water-break · ใส่ strike ชั้นแรก</td>
            </tr>
            <tr>
              <td data-i18n-key="t2_s">ลอกขอบ/มุม</td>
              <td data-i18n-key="t2_c">CD สูงเฉพาะจุด/ไม่มีชิลด์</td>
              <td data-i18n-key="t2_f">ติดชิลด์/ลดแรงดัน · ปรับระยะขั้ว/จิ๊ก</td>
            </tr>
            <tr>
              <td data-i18n-key="t3_s">ปื้นเปราะ/เป็นผง</td>
              <td data-i18n-key="t3_c">Over-bright/อินทรีย์สะสม</td>
              <td data-i18n-key="t3_f">คาร์บอนทรีต · รีเฟรชอ่าง · รีบาลานซ์ brightener</td>
            </tr>
            <tr>
              <td data-i18n-key="t4_s">หลุดตามรอยเชื่อม/รูพรุน</td>
              <td data-i18n-key="t4_c">ก๊าซค้าง/สิ่งสกปรกในรู</td>
              <td data-i18n-key="t4_f">กวน/สูบน้ำผ่านรู · อัลตร้าโซนิก · เพิ่มรอบล้าง</td>
            </tr>
            <tr>
              <td data-i18n-key="t5_s">ลอกหลังอบ/ประกอบ</td>
              <td data-i18n-key="t5_c">ฟิล์มหนาเกิน/ความต่าง CTE</td>
              <td data-i18n-key="t5_f">ลดความหนา · อบปรับสภาพก่อน</td>
            </tr>
            <tr>
              <td data-i18n-key="t6_s">ลอกไม่หมดตอน Strip</td>
              <td data-i18n-key="t6_c">อุณหภูมิ/เข้มข้นต่ำ · สูตรไม่ตรงโลหะ</td>
              <td data-i18n-key="t6_f">เพิ่ม T/conc/agitation ตามสเปก · เปลี่ยนสูตรให้ตรงชั้นชุบ</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <section id="links" data-part="2" class="reveal section-block" aria-labelledby="links-h">
      <h2 id="links-h" class="section" data-i18n-key="links_h">ลิงก์ที่เกี่ยวข้อง</h2>
      <p><a class="more" href="https://www.baumechemical.com/products/pretreatment/" data-i18n-key="link_pretreat">Pretreatment</a></p>
      <p><a class="more" href="https://www.baumechemical.com/products/platingcoating/" data-i18n-key="link_plating">Plating</a></p>
      <p><a class="more" href="https://www.baumechemical.com/products/strippers/" data-i18n-key="link_strip">Strippers</a></p>
      <p><a class="more" href="https://www.baumechemical.com/products/equipment/" data-i18n-key="link_equip">Equipment</a></p>
      <p><a class="more" href="https://www.baumechemical.com/contact/" data-i18n-key="link_service">บริการหน้างาน</a></p>
    </section>
  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="footer-inner">
      <div class="footer-grid">
        <section class="footer-brand">
          <div class="ft-head"><div class="ft-logo"></div><div class="ft-name">Baume Chemical</div></div>
          <ul class="footer-list">
            <li>📍 31 ซอย เพชรเกษม 48 แยก 24 แขวง บางแวก</li>
            <li>📍 เขต ภาษีเจริญ กรุงเทพมหานคร 10160</li>
            <li>🕒 เวลาทำการ 08.00 - 17.00 น.</li>
            <li>📱 <a href="tel:+66925469887">092 546 9887</a></li>
          </ul>
        </section>

        <nav aria-label="หมวดหมู่ผลิตภัณฑ์">
          <h3 class="footer-title" data-i18n-key="footer_products">หมวดผลิตภัณฑ์</h3>
          <ul class="footer-list">
            <li><a href="https://www.baumechemical.com/products/pretreatment/">Pretreatment</a></li>
            <li><a href="https://www.baumechemical.com/products/platingcoating/">Plating</a></li>
            <li><a href="https://www.baumechemical.com/products/blackening/">Blackening</a></li>
            <li><a href="https://www.baumechemical.com/products/passivation/">Passivation</a></li>
            <li><a href="https://www.baumechemical.com/products/polishing/">Polishing</a></li>
            <li><a href="https://www.baumechemical.com/products/strippers/">Strippers</a></li>
            <li><a href="https://www.baumechemical.com/products/protective/">Protective Treatment</a></li>
            <li><a href="https://www.baumechemical.com/products/equipment/">Equipment</a></li>
          </ul>
        </nav>

        <section aria-label="ติดต่อเรา">
          <h3 class="footer-title" data-i18n-key="footer_contact">ติดต่อเรา</h3>
          <ul class="footer-list">
            <li>✉️ : <a href="mailto:contact@baumechemical.com">contact@baumechemical.com</a></li>
            <li>💬 : <a href="https://line.me/ti/p/~baumechemical" target="_blank" rel="noopener">@baumechemical</a></li>
            <li>🌐 : <a href="https://www.baumechemical.com/">baumechemical.com</a></li>
          </ul>
        </section>
      </div>
      <div class="footer-bottom"><div data-i18n-key="footer_copy">© 2025 Baume Chemical. All rights reserved.</div></div>
    </div>
  </footer>
  <!-- JS: Reveal on scroll -->
  <script>
    const revealEls = document.querySelectorAll('.reveal');
    const revObs = new IntersectionObserver((entries,obs)=>{
      entries.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('show'); obs.unobserve(e.target);} });
    }, {threshold:.18});
    revealEls.forEach(el=>revObs.observe(el));
  </script>

  <!-- JS: i18n + working language switch -->
  <script>
    const I18N = {
      th: {
        nav_home:"Home", nav_about:"About us", nav_products:"Products", nav_contact:"Contact Us", nav_blog:"Blog",
        back_home:"← กลับเมนูหลัก",
        hero_title:"ชุบลอก/ลอกไม่หมด: สาเหตุ & วิธีแก้",
        hero_tagline:"เช็คลิสต์ 3 นาที · 5 ต้นเหตุหลัก · วิธีเตรียมผิว/โปรไฟล์ไฟ/ดูแลอ่าง · การทดสอบยึดเกาะ · เคสลอกไม่หมด · ตารางปัญหา–วิธีแก้",

        part1:"พาร์ต 1: TL;DR/สาเหตุ/เตรียมผิว/โปรไฟล์ไฟ/อ่าง",
        part2:"พาร์ต 2: QA/Strip ตารางปัญหา & ลิงก์",

        toc_title:"สารบัญ", toc_tl:"TL;DR – เช็คเร็ว", toc_causes:"ต้นเหตุหลัก", toc_prep:"การเตรียมผิว/Activation", toc_power:"โปรไฟล์ไฟ/การจัดวาง", toc_bath:"อ่างชุบ & สารเติมแต่ง", toc_qa:"การทดสอบยึดเกาะ (QA)", toc_strip:"ลอกไม่หมดตอน Strip", toc_table:"ตารางปัญหา–วิธีแก้", toc_links:"ลิงก์ที่เกี่ยวข้อง",

        tl_h:"TL;DR – เช็คเร็ว 3 ข้อ",
        tl_1:"ผิวสะอาด/Active จริง? (ไม่มีน้ำมัน/ออกไซด์, ผ่าน water-break)",
        tl_2:"โปรไฟล์ไฟเหมาะกับชิ้นงาน? (A/dm² ตรงสเปก, มีชิลด์/กระแสกระจายทั่ว)",
        tl_3:"อ่างคงที่? (โลหะหลัก/สารเติมแต่ง/pH/อุณหภูมิบนสเปก, กรองดี)",
        tl_note:"“ลอกยกแผ่น” มักมาจากชั้นแรกยึดเกาะกับโลหะพื้นไม่ดี; “ลอกเป็นจุด/ขอบไหม้” มักเกี่ยวกับโปรไฟล์ไฟหรือสิ่งปนเปื้อนเฉพาะจุด",

        causes_h:"ต้นเหตุหลัก 5 กลุ่ม",
        c1:"ความสะอาดไม่พอ — คราบน้ำมัน/ออกไซด์/สารตกค้าง",
        c2:"Activation ไม่ครบ — Fe/SS/Al/Zn die-cast ต้องขั้นพิเศษ",
        c3:"Over-bright/อินทรีย์ล้น — ชั้นชุบเปราะ/ติดบนผิว passivation",
        c4:"โปรไฟล์ไฟไม่เหมาะ — CD สูง/ต่ำไป, ขอบแหลมไม่มีชิลด์, ripple สูง",
        c5:"อ่างเสื่อม/ปนเปื้อน — โลหะเจือ/คลอไรด์เกิน, pH/อุณหภูมิแกว่ง",

        prep_h:"การเตรียมผิว & Activation",
        p1:"ดีเกรส/ล้างไขมัน → ล้าง DI",
        p2:"กัดคราบ/ดองผิว (etch/pickle) ให้ผิวใหม่สด",
        p3:"Activation ตามโลหะพื้น (SS: กรด/คอลลอยด์ Pd สำหรับ EN; Al/Zn: เดสมัต + zincate; Ni เก่า: strike บางก่อน)",
        p4:"Water-break test — น้ำต้องไหลเป็นแผ่นต่อเนื่อง",

        power_h:"โปรไฟล์ไฟ & การวางชิ้นงาน",
        pw1:"เริ่ม CD ช่วงกลางของสเปกอ่าง แล้วค่อยปรับทีละขั้น",
        pw2:"ขอบ/มุม ใช้ชิลด์หรือ current thief ลดไหม้/ลอกขอบ",
        pw3:"ระยะขั้วเหมาะสม ลดความต่างศักย์เฉพาะจุด",
        pw4:"ใช้เรคติไฟเออร์ ripple ต่ำ; บางงานใช้ pulse/pulse-reverse ช่วย",
        pw5:"กวน/ไหลเวียนให้ผลิตภัณฑ์ปฏิกิริยาไม่ค้างหน้าชิ้นงาน",

        bath_h:"อ่างชุบ & สารเติมแต่ง",
        b1:"วิเคราะห์โลหะหลัก/คลอไรด์/บอเรต/คาร์บอเนตตามกราฟ",
        b2:"ติดตามอินทรีย์/brightener — เกินทำให้เปราะ; คาร์บอนทรีตเมื่อจำเป็น",
        b3:"คุม pH/อุณหภูมิให้คงที่ด้วยเครื่องมือสอบเทียบ",
        b4:"กรองละเอียด 1–5 µm และแยกน้ำมันเพื่อลด pitting/คราบ",

        qa_h:"การทดสอบยึดเกาะ (QA)",
        qa_th_test:"การทดสอบ", qa_th_crit:"เกณฑ์โดยย่อ",
        qa_cross:"Cross-hatch + เทป", qa_cross_c:"ตัด 1–2 มม. ดึงเทป ไม่ยกแผ่นตามรอย",
        qa_bend:"Bend test", qa_bend_c:"งอ 180° ไม่ลอกเป็นแผ่น/ร้าว",
        qa_thermal:"Thermal shock", qa_thermal_c:"ร้อน–เย็นสลับ ไม่ปริ/ลอก",
        qa_hull:"Hull cell + ความหนา", qa_hull_c:"หน้าต่างอ่างสม่ำเสมอ ไม่ over-bright",

        strip_h:"“ลอกไม่หมด” ตอน Strip — เอาไงดี",
        s1:"เลือกสูตรให้ตรงชั้นชุบ (Cu/Ni/Cr/Sn/Zn) และป้องกันโลหะพื้น",
        s2:"เพิ่มอุณหภูมิ/ความเข้มข้น/การกวนในกรอบสเปก",
        s3:"ชิ้นซับซ้อนต้องกวน/ไหลเวียนดี ลดก๊าซกั้นผิว",
        s4:"ชั้นผสม (Ni–P, Sn–Pb) อาจต้องสูตรเฉพาะ/ตัวเร่ง",
        s5:"ล้างหลังลอกให้สะอาด เดสมัตเบาก่อนวนกลับไลน์",
        strip_safe:"ความปลอดภัย: สารลอกบางชนิดมีไซยาไนด์/ออกซิแดนต์แรง → ปฏิบัติตาม SDS และระบบกำจัดของเสีย",

        tab_h:"ตารางปัญหา – สาเหตุ – วิธีแก้",
        tab_sym:"อาการ", tab_cause:"สาเหตุที่พบบ่อย", tab_fix:"แนวทางแก้",
        t1_s:"ลอกยกแผ่นทั้งผิว", t1_c:"ผิวไม่ Active/มีน้ำมัน/ออกไซด์", t1_f:"เพิ่มดีเกรส/etch/activate · ตรวจ water-break · ใส่ strike ชั้นแรก",
        t2_s:"ลอกขอบ/มุม", t2_c:"CD สูงเฉพาะจุด/ไม่มีชิลด์", t2_f:"ติดชิลด์/ลดแรงดัน · ปรับระยะขั้ว/จิ๊ก",
        t3_s:"ปื้นเปราะ/เป็นผง", t3_c:"Over-bright/อินทรีย์สะสม", t3_f:"คาร์บอนทรีต · รีเฟรชอ่าง · รีบาลานซ์ brightener",
        t4_s:"หลุดตามรอยเชื่อม/รูพรุน", t4_c:"ก๊าซค้าง/สิ่งสกปรกในรู", t4_f:"กวน/สูบน้ำผ่านรู · อัลตร้าโซนิก · เพิ่มรอบล้าง",
        t5_s:"ลอกหลังอบ/ประกอบ", t5_c:"ฟิล์มหนาเกิน/ความต่าง CTE", t5_f:"ลดความหนา · อบปรับสภาพก่อน",
        t6_s:"ลอกไม่หมดตอน Strip", t6_c:"อุณหภูมิ/เข้มข้นต่ำ · สูตรไม่ตรงโลหะ", t6_f:"เพิ่ม T/conc/agitation ตามสเปก · เปลี่ยนสูตรให้ตรงชั้นชุบ",

        links_h:"ลิงก์ที่เกี่ยวข้อง",
        link_pretreat:"Pretreatment", link_plating:"Plating", link_strip:"Strippers", link_equip:"Equipment", link_service:"บริการหน้างาน",

        footer_products:"หมวดผลิตภัณฑ์", footer_contact:"ติดต่อเรา", footer_copy:"© 2025 Baume Chemical. All rights reserved."
      },

      en: {
        nav_home:"Home", nav_about:"About us", nav_products:"Products", nav_contact:"Contact Us", nav_blog:"Blog",
        back_home:"← Back to Home",
        hero_title:"Plating Peeling / Stripping Incomplete: Causes & Fixes",
        hero_tagline:"3-minute checklist · 5 root causes · Prep/current/bath guidance · Adhesion tests · Stripping not complete · Troubleshooting table",

        part1:"Part 1: TL;DR/Root causes/Prep/Power/Bath",
        part2:"Part 2: QA/Stripping Table & Links",

        toc_title:"Contents", toc_tl:"TL;DR – Quick checks", toc_causes:"Root causes", toc_prep:"Surface prep/Activation", toc_power:"Power profile/Fixturing", toc_bath:"Bath & Additives", toc_qa:"Adhesion tests (QA)", toc_strip:"“Stripping not complete”", toc_table:"Troubleshooting table", toc_links:"Related links",

        tl_h:"TL;DR – 3 quick checks",
        tl_1:"Surface truly clean/active? (no oils/oxides; passes water-break)",
        tl_2:"Right current profile? (spec A/dm²; shields; uniform distribution)",
        tl_3:"Stable bath? (key metals/additives, pH & temp on spec; good filtration)",
        tl_note:"Sheet-like peel = poor first-layer adhesion to base metal; edge/spot peel = current profile or localized contamination.",

        causes_h:"Five root-cause groups",
        c1:"Insufficient cleanliness — oils/oxides/residues",
        c2:"Incomplete activation — Fe/SS/Al/Zn die-cast need tailored steps",
        c3:"Over-bright/excess organics — brittle deposit/passivated surface",
        c4:"Improper current profile — too high/low CD, unshielded edges, high ripple",
        c5:"Degraded/contaminated bath — tramp metals/chloride, drifting pH/temp",

        prep_h:"Surface prep & activation",
        p1:"Degrease → DI rinse",
        p2:"Etch/pickle to expose fresh metal",
        p3:"Activation by substrate (SS: acid/Pd for EN; Al/Zn: desmut + zincate; old Ni: thin strike first)",
        p4:"Water-break: continuous sheet = good wetting",

        power_h:"Power & fixturing",
        pw1:"Start mid-spec current density; adjust stepwise",
        pw2:"Shield edges or use current thieves",
        pw3:"Maintain proper anode–cathode spacing",
        pw4:"Low-ripple rectifier; consider pulse/pulse-reverse",
        pw5:"Agitation/flow to clear reaction products",

        bath_h:"Bath & additives",
        b1:"Track key metals/chloride/borate/carbonate vs. control charts",
        b2:"Watch organics/brightener; carbon-treat if excessive",
        b3:"Keep pH/temperature stable with calibrated meters",
        b4:"Fine filtration (1–5 µm) and oil separation",

        qa_h:"Adhesion tests (QA)",
        qa_th_test:"Test", qa_th_crit:"Pass criteria",
        qa_cross:"Cross-hatch + tape", qa_cross_c:"1–2 mm grid; standard tape pull; no flaking",
        qa_bend:"Bend test", qa_bend_c:"180° around mandrel; no sheet-like peeling",
        qa_thermal:"Thermal shock", qa_thermal_c:"Hot–cold cycles; no cracks/peel",
        qa_hull:"Hull cell + thickness", qa_hull_c:"Stable window; no over-bright/porosity",

        strip_h:"“Stripping not complete” — fixes",
        s1:"Match stripper to deposit (Cu/Ni/Cr/Sn/Zn) and protect base metal",
        s2:"Raise temperature/concentration/agitation within spec",
        s3:"Improve flow for cavities; avoid trapped gas",
        s4:"Use specialty grades for mixed deposits (Ni–P, Sn–Pb)",
        s5:"Rinse thoroughly; light desmut before re-processing",
        strip_safe:"Safety: some strippers contain cyanide/strong oxidizers — follow SDS & waste treatment rules.",

        tab_h:"Troubleshooting — Symptom / Cause / Fix",
        tab_sym:"Symptom", tab_cause:"Likely causes", tab_fix:"Fix",
        t1_s:"Sheet-like peel", t1_c:"Non-active surface; oils/oxides", t1_f:"Improve clean/etch/activate; water-break; add strike layer",
        t2_s:"Edge peel/burn", t2_c:"High local CD; no shielding", t2_f:"Shields/thieves; reduce voltage; adjust spacing/jig",
        t3_s:"Brittle/powdery", t3_c:"Over-bright; organics build-up", t3_f:"Carbon treat; refresh bath; rebalance additives",
        t4_s:"Peel at weld/holes", t4_c:"Trapped gas/soil", t4_f:"Stronger agitation/ultrasonic; extra rinses/flow-through",
        t5_s:"Post-bake peel", t5_c:"Excess thickness; CTE mismatch", t5_f:"Reduce thickness; pre-bake/conditioning",
        t6_s:"Stripping incomplete", t6_c:"Low T/conc; wrong chemistry", t6_f:"Raise T/conc/flow; switch to correct stripper",

        links_h:"Related links",
        link_pretreat:"Pretreatment", link_plating:"Plating", link_strip:"Strippers", link_equip:"Equipment", link_service:"On-site Service",

        footer_products:"Products", footer_contact:"Contact Us", footer_copy:"© 2025 Baume Chemical. All rights reserved."
      }
    };

    const els = {
      langBtns: () => document.querySelectorAll('.lang-switch .lang-btn'),
      translatables: () => document.querySelectorAll('[data-i18n-key]')
    };

    function applyLang(lang){
      const sel = (lang === 'en') ? 'en' : 'th';
      document.documentElement.lang = sel;
      els.langBtns().forEach(btn => btn.setAttribute('aria-pressed', String(btn.dataset.lang === sel)));
      els.translatables().forEach(node => {
        const key = node.getAttribute('data-i18n-key');
        if (key && I18N[sel] && I18N[sel][key]) node.textContent = I18N[sel][key];
      });
      try{
        localStorage.setItem('lang', sel);
        const h = document.getElementById('siteHeader').getBoundingClientRect().height|0;
        document.documentElement.style.setProperty('--header-h', h + 'px');
      }catch(e){}
    }

    (function initLang(){
      const saved = (typeof localStorage !== 'undefined' && localStorage.getItem('lang')) || 'th';
      applyLang(saved);
      els.langBtns().forEach(btn=> btn.addEventListener('click', ()=> applyLang(btn.dataset.lang)));
    })();
  </script>

  <!-- JS: Part switcher (persist + deep-link + TOC click sync) -->
  <script>
    (function(){
      const buttons = document.querySelectorAll('.part-switch .part-btn');
      const tocLinks = document.querySelectorAll('#toc a[data-part]');
      const sections = document.querySelectorAll('section[data-part]');

      function setPart(p){
        const part = (p === '2') ? '2' : '1';
        document.documentElement.setAttribute('data-part', part);
        sections.forEach(sec => sec.hidden = (sec.dataset.part !== part));
        tocLinks.forEach(a => a.hidden = (a.dataset.part !== part));
        buttons.forEach(b => {
          const on = (b.dataset.part === part);
          b.setAttribute('aria-pressed', String(on));
          b.setAttribute('aria-selected', String(on));
        });
        try{
          localStorage.setItem('peel_part', part);
          const url = new URL(location);
          url.searchParams.set('part', part);
          history.replaceState(null,'',url);
        }catch(e){}
      }

      const urlPart = new URLSearchParams(location.search).get('part');
      const saved = (typeof localStorage !== 'undefined' && localStorage.getItem('peel_part')) || '1';
      setPart(urlPart === '2' ? '2' : (urlPart === '1' ? '1' : saved));

      buttons.forEach(b => b.addEventListener('click', ()=>{
        setPart(b.dataset.part);
        document.getElementById('toc')?.scrollIntoView({behavior:'smooth', block:'start'});
      }));

      tocLinks.forEach(a=> a.addEventListener('click', ()=> setPart(a.getAttribute('data-part'))));
    })();
  </script>

  <!-- JS: Header glass (darken on scroll) + mobile menu (scrim+lock) + nav highlight + smart back -->
  <script>
    (function(){
      const header = document.getElementById('siteHeader');
      const toggle = header?.querySelector('.nav-toggle');
      const nav = document.getElementById('primary-nav');
      const scrim = document.querySelector('.menu-scrim');

      // Header height var & darken on scroll
      function setH(){
        const h = header ? Math.round(header.getBoundingClientRect().height) : 64;
        document.documentElement.style.setProperty('--header-h', h + 'px');
      }
      function onScroll(){
        header && header.classList.toggle('is-scrolled', (window.scrollY||0) > 10);
      }
      window.addEventListener('load', setH, {once:true});
      window.addEventListener('resize', setH, {passive:true});
      window.addEventListener('scroll', onScroll, {passive:true});
      setH(); onScroll();

      // Mobile menu open/close + body lock
      if(toggle && nav && scrim){
        let lockY = 0;
        function openMenu(v){
          header.classList.toggle('open', v);
          toggle.setAttribute('aria-expanded', String(v));
          nav.setAttribute('aria-hidden', String(!v));
          v ? scrim.removeAttribute('hidden') : scrim.setAttribute('hidden','');
          if(v){
            lockY = window.scrollY;
            document.body.classList.add('no-scroll');
            document.body.style.top = `-${lockY}px`;
          }else{
            document.body.classList.remove('no-scroll');
            document.body.style.top = '';
            window.scrollTo(0, lockY);
            toggle.focus({preventScroll:true});
          }
        }
        toggle.addEventListener('click', ()=> openMenu(!header.classList.contains('open')));
        scrim.addEventListener('click', ()=> openMenu(false));
        document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && header.classList.contains('open')) openMenu(false); });
        window.addEventListener('resize', ()=>{ if (window.innerWidth > 900 && header.classList.contains('open')) openMenu(false); }, {passive:true});
        nav.querySelectorAll('a').forEach(a => a.addEventListener('click', ()=> openMenu(false)));
      }

      // Highlight current page; force Products when under /products/*
      try{
        const here = location.pathname.replace(/\/+$/,'');
        nav?.querySelectorAll('a').forEach(a=>{
          const path = new URL(a.getAttribute('href'), location.origin).pathname.replace(/\/+$/,'');
          a.removeAttribute('aria-current');
          if (/^\/products(\/|$)/.test(here) && /\/products\/?$/.test(path)) a.setAttribute('aria-current','page');
          else if (here === path) a.setAttribute('aria-current','page');
        });
      }catch(e){}

      // Smart back: prefer history if same-origin
      (function(){
        const btn = document.querySelector('[data-back]');
        if(!btn) return;
        btn.addEventListener('click', function(e){
          try{
            const ref = document.referrer;
            const sameOrigin = ref && new URL(ref).origin === location.origin;
            if(sameOrigin){ e.preventDefault(); history.back(); }
          }catch(err){}
        });
      })();
    })();
  </script>

  <!-- JS: Scroll-spy for TOC + heading anchors -->
  <script>
    // Clickable heading anchors (adds #id when clicking the H2)
    document.querySelectorAll('.section-block>h2.section').forEach(h=>{
      h.addEventListener('click', ()=>{
        const sec = h.closest('.section-block');
        if(sec && sec.id){ history.pushState(null,'','#'+sec.id); }
      });
    });

    (function(){
      const tocLinks = Array.from(document.querySelectorAll('#toc a[href^="#"]'));
      if (!tocLinks.length) return;
      const map = new Map();
      tocLinks.forEach(a=>{
        const id = a.getAttribute('href').slice(1);
        const el = document.getElementById(id);
        if (el) map.set(id, {link:a, el});
      });

      const setActive = (id)=>{
        tocLinks.forEach(a=> a.classList.remove('is-active'));
        tocLinks.forEach(a=> a.setAttribute('aria-current','false'));
        const item = map.get(id);
        if (item){ item.link.classList.add('is-active'); item.link.setAttribute('aria-current','true'); }
      };

      const headerH = ()=> parseInt(getComputedStyle(document.documentElement).getPropertyValue('--header-h'))||56;
      const obs = new IntersectionObserver((entries)=>{
        entries.forEach(e=>{
          if (e.isIntersecting && !e.target.hidden){
            const id = e.target.id;
            setActive(id);
            history.replaceState(null,'', `${location.pathname}${location.search}#${id}`);
          }
        });
      }, {rootMargin: `-${headerH()+24}px 0% -60% 0%`, threshold:.1});

      map.forEach(({el})=> obs.observe(el));
    })();
  </script>
</body>
</html>
